<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Снова в гонке</title>
    <link rel="stylesheet" href="libs/dist/leaflet.css" />
    <link rel="stylesheet" href="libs/style.css">
</head>

<body>
    <div id="container">
        <div id="filter-toggle-container">
            <button id="filter-toggle-btn">Фильтры</button>
            <div id="filter-panel">
                <h3>Фильтр магазинов</h3>
                <label><input type="checkbox" class="filter-check" value="ушли" checked> Магазины, которые
                    ушли</label><br>
                <label><input type="checkbox" class="filter-check" value="реселлеры" checked> Реселлеры</label><br>
                <label><input type="checkbox" class="filter-check" value="бутики" checked> Бутики</label><br>
                <label><input type="checkbox" class="filter-check" value="секонд" checked> Секенд хенды</label>
            </div>
        </div>

        <div id="search-container">
            <input type="text" id="shop-search" placeholder="Поиск магазина..." autocomplete="off">
            <ul id="search-results"></ul>
        </div>

        <div id="map"></div>

        <div id="shop-info-panel">
            <div id="shop-info-content">
                <span id="close-info">✕</span>
                <div id="shop-info-body">Выберите магазин на карте</div>
            </div>
        </div>
    </div>

    <script src="libs/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-yandex@1.0.1/dist/leaflet-yandex.js"></script>

    <script>
        const map = L.map('map', {
            attributionControl: false,
            zoomControl: false
        }).setView([55.751244, 37.618423], 11);

        L.tileLayer('https://a.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
            attribution: '',
            maxZoom: 19
        }).addTo(map);

        L.control.attribution({ prefix: false }).addTo(map);

        document.addEventListener('DOMContentLoaded', () => {
            const closeBtn = document.getElementById('close-info');
            const panel = document.getElementById('shop-info-panel');
            closeBtn.addEventListener('click', () => {
                panel.classList.remove('show');
            });
        });

        const zoomControl = L.control.zoom({ position: 'bottomleft' }).addTo(map);

        fetch('map.geojson')
            .then(response => response.json())
            .then(data => {
                L.geoJSON(data, {
                    style: {
                        color: 'red',
                        weight: 3,
                        opacity: 0.8
                    }
                }).addTo(map).bindPopup('МКАД');
            })
            .catch(error => {
                console.error('Ошибка загрузки GeoJSON:', error);
            });

        document.addEventListener('DOMContentLoaded', () => {
            const toggleBtn = document.getElementById('filter-toggle-btn');
            const panel = document.getElementById('filter-panel');
            toggleBtn.addEventListener('click', () => {
                panel.classList.toggle('active');
            });
        });

        document.addEventListener('click', (e) => {
            const panel = document.getElementById('filter-panel');
            const toggleBtn = document.getElementById('filter-toggle-btn');
            if (!panel.contains(e.target) && !toggleBtn.contains(e.target)) {
                panel.classList.remove('active');
            }
        });
    </script>

    <script type="text/javascript" src="./libs/main.js"></script>
    <script type="text/javascript" src="./libs/markers.js"></script>
</body>

</html>
